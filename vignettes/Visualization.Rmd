---
title: "Visualization with helixvis"
author: "Raoul R. Wadhwa"
date: "`r Sys.Date()`"
output: rmarkdown::html_vignette
fig_caption: yes
vignette: >
  %\VignetteIndexEntry{Visualization with helixvis}
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteEncoding{UTF-8}
references:
- id: helical-wheel
  title: Use of Helical Wheels to Represent the Structures of Proteins and to Identify Segments with Helical Potential
  author:
  - family: Schiffer
    given: Marianne
  - family: Edmundson
    given: Allen
  container-title: Biophysical Journal
  volume: 7
  issue: 2
  page: 121-135
  type: article-journal
  issued:
    year: 1967
    month: 3
- id: wenxiang-diagram
  author:
  - family: Chou
    given: Kou-Chen
  - family: Zhang
    given: Chun-Ting
  - family: Maggiora
    given: Gerald
  container-title: "Proteins: Structure, Function, and Genetics"
  volume: 28
  issue: 1
  page: 99-108
  type: article-journal
  issued:
    year: 1997
    month: 5
nocite: |
  @helical-wheel, @wenxiang-diagram
---

```{r setup, echo = FALSE, results = "hide"}
# given in "R Packages" by Wickham for displaying comments
knitr::opts_chunk$set(collapse = TRUE, comment = "#>")
```

# Visualizing alpha-helical peptides with helixvis

## Background

Include a paragraph about $\alpha$-helical peptides in the context of
protein structure.
Proteins are a major class of biochemical macromolecules composed of linear chains of building blocks, known as amino acids. There are 20 standard amino acids, and 2 newer proteinogenic amino acids (selenocysteine and pyrrolysine) that are classified based on the biochemistry of their side chains (see Table below). Note that amino acids are also known as residues.

```{r aa_table, echo = FALSE, fig.cap = "List of 22 proteinogenic amino acids supported for visualization by helixvis."}
aa_data <- data.frame(Name = c("Alanine",
                               "Arginine",
                               "Asparagine",
                               "Aspartic Acid",
                               "Cysteine",
                               "Glutamic Acid",
                               "Glutamine",
                               "Glycine",
                               "Histidine",
                               "Isoleucine",
                               "Leucine",
                               "Lysine",
                               "Methionine",
                               "Phenylalanine",
                               "Proline",
                               "Serine",
                               "Threonine",
                               "Tryptophan",
                               "Tyrosine",
                               "Valine",
                               "Selenocysteine",
                               "Pyrrolysine"),
                      Code = c("A",
                               "R",
                               "N",
                               "D",
                               "C",
                               "E",
                               "Q",
                               "G",
                               "H",
                               "I",
                               "L",
                               "K",
                               "M",
                               "F",
                               "P",
                               "S",
                               "T",
                               "W",
                               "Y",
                               "V",
                               "U",
                               "O"),
                      Type = c("Hydrophobic",
                               "Charged",
                               "Hydrophilic",
                               "Charged",
                               "Hydrophilic",
                               "Charged",
                               "Hydrophilic",
                               "Hydrophobic",
                               "Charged",
                               "Hydrophobic",
                               "Hydrophobic",
                               "Charged",
                               "Hydrophobic",
                               "Hydrophobic",
                               "Hydrophilic",
                               "Hydrophilic",
                               "Hydrophilic",
                               "Hydrophobic",
                               "Hydrophobic",
                               "Hydrophobic",
                               "Hydrophilic",
                               "Charged"))
knitr::kable(aa_data)
```

Proteins are generally described at four levels:

  1. **Primary structure:** describes the sequence of residues of which a protein is composed.
  1. **Secondary structure:** describes the local shape of a short subsequence of the protein. The $\alpha$-helix and $\beta$-sheet are common examples of secondary structure.
  1. **Tertiary structure:** describes the folding of a single peptide chain.
  1. **Quaternary structure:** describes the folding caused by interactions between multiple peptide chains.
  
This package focuses on visualizing secondary structure. Specifically, helixvis produces 2-dimensional visualizations of the 3-dimensional $\alpha$-helical secondary structure of sequences. Note that helixvis does not determine the secondary structure of peptide sequences; rather, it assumes a standard $\alpha$-helical structure, and produces the corresponding visualization.

## Create helical wheels with helixvis

Helical wheels were introduced by Schiffer and Edmundson (1967) as two-dimensional figures representing known three-dimensional $\alpha$-helical structures. They present a bird's eye view of a subsequence of length 18 of an $\alpha$-helical sequence in which all 18 residues can be seen. However, helical wheels do not provide any indication of distance away from the top of the helix; i.e., all 18 residues appear to have the same depth.

The following line of code demonstrates how a user can generate a single helical wheel using a test sequence. The image that follows is of the generated wheel; note that the top of the figure includes the provided name of the sequence, as well as the sequence itself.

```{r wheel_code}
helixvis::draw_wheel("Test Wheel", "AKDEWWREKLYIGYWREL")
```

```{r wheel_image, echo = FALSE, fig.cap = "Helical wheel for the sequence AKDEWWREKLYIGYWREL."}
knitr::include_graphics("Test Wheel.png")
```

When generating helical wheels, helixvis outputs "SUCCESS" to the console for every successfully generated PNG file. Otherwise, the cause of failure is printed to the console. In case of issues that you cannot fix after reasonable effort, please contact the maintainer of helixvis via email.

The following line of code demonstrates how a user can generate multiple helical wheels using the `draw_wheel` function (generated figures not shown). The function will work correctly as long as `name` and `seq` are character vectors of equal length.

```{r mult_wheel_code, eval = FALSE}
helixvis::draw_wheel(c("Test1", "Test2"),
                     c("ABCDABCDABCDABCDAB",
                       "DCBADCBADCBADCBADC"))
```

Thus, given a data frame containing two columns, one for the sequence name and for the sequence of residues, a user can easily generate helical wheels for all the sequences by supplying the appropriate columns to `draw_wheel` under `name` and `seq`. A warning to the user: if the `name` vector contains identical elements, only the PNG for the element processed last will be available, as all earlier sequences with the same name will have their corresponding PNG images overwritten.

## Create wenxiang diagrams with helixvis

Wenxiang diagrams were introduced by Chou et al. (1997), three decades after the introduction of helical wheels, as an alternative to the closely related visualization. While wenxiang diagrams also provide a bird's eye view of a subsequence of an $\alpha$-helical structure, the distance of a residue from the center signifies the residue's distance from the residue nearest to the viewer, providing more information than the helical wheel. However, the polar coordinates used by the wenxiang diagram provide significant distance distortion as the residues get farther away from the center.

helixvis's `draw_wenxiang` function can generate wenxiang diagrams for sequences less than or equal to 19 residues in length; this is one residue longer than the helical wheels. The following line of code demonstrates how a user can generate a single wenxiang diagram using a test sequence. The image that follows is of the generated wenxiang diagram; note that the top of the figure includes the provided name of the sequence, as well as the sequence itself.

```{r wenxiang_code}
helixvis::draw_wenxiang("Test Wenxiang", "AKDEWWREKLYIGYWREL")
```

```{r wenxiang_image, echo = FALSE, fig.cap = "Wenxiang diagram for the sequence AKDEWWREKLYIGYWREL."}
knitr::include_graphics("Test Wenxiang.png")
```

When generating wenxiang diagrams, helixvis outputs "SUCCESS" to the console for every successfully generated PNG file. Otherwise, the cause of failure is printed to the console. In case of issues that you cannot fix after reasonable effort, please contact the maintainer of helixvis via email.

The following line of code demonstrates how a user can generate multiple wenxiang diagrams using the `draw_wenxiang` function (generated figures not shown). The function will work correctly as long as `name` and `seq` are character vectors of equal length.

```{r mult_wenxiang_code, eval = FALSE}
helixvis::draw_wenxiang(c("Test1", "Test2"),
                        c("ABCDABCDABCDABCDAB",
                          "DCBADCBADCBADCBADC"))
```

Thus, given a data frame containing two columns, one for the sequence name and for the sequence of residues, a user can easily generate wenxiang diagrams for all the sequences by supplying the appropriate columns to `draw_wheel` under `name` and `seq`. A warning to the user: if the `name` vector contains identical elements, only the PNG for the element processed last will be available, as all earlier sequences with the same name will have their corresponding PNG images overwritten.

# Benefits of helixvis

The primary benefit of helixvis is that given an appropriately formatted database of sequences, only two lines of code can produce helical wheels and wenxiang diagrams for all the desired sequences. Additionally, the figures are publication-quality, and are provided to the user in an easily usable PNG format. This is in contrast to most web servers that draw either helical wheels or wenxiang diagrams, which require manual input of individual sequences, followed by individual downloads of the generated figures.

The visualizations produced by the use of helixvis are most likely to be used in the study of amphiphilic $\alpha$-helices. In this context, a residue's side chain type is generally more important than its exact identity. To make analysis of side chains easier, helixvis does not include the identity of the residues on the visualization itself; this also makes the visualizations less distracting due to too much information. Note that since the sequence is listed on the top of each figure, it can be easily determined which residue corresponds to which filled circle in the visualization.

Lastly, scientific progress has resulted in the discovery of two new proteinogenic amino acids in addition to the 20 standard amino acids, namely Selenocysteine (U) and Pyrrolysine (O). Recognizing that some projects require visualization of sequences containing these two amino acids, helixvis supports their occurrences in sequences, and appropriately colors and visualizes them.

# References
